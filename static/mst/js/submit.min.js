var submit={server:mst_config_server,socket:null,btn:null,res:false};function addHeaders(t,a){$("#headers_div").html($("#headers_div").html()+'<div class="col-xs-4"><input type="text" class="form-control myinput headers" placeholder="KEY" value="'+t+'"></div><div class="col-xs-8"><input type="text" class="form-control myinput headers" placeholder="VALUE" value="'+a+'"></div>');$(".myinput").change(function(t){preview()});preview()}function enabledInput(){$(".myinput").attr("disabled",false)}function disabledInput(){$(".myinput").attr("disabled","disabled")}function checkInput(){var t=true;$(".mustinput").each(function(){if($(this).val()===""){$(this).attr("class","form-control myinput mustinput label-warning");$(this).focus(function(){$(this).attr("class","form-control myinput mustinput")});t=false}});return t}function preview(){var t="<pre>";t+='<strong class="text-danger">'+$(".myinput[name='poc_method']").val()+"</strong> ";t+=$(".myinput[name='opt_path']").val();t+=$(".myinput[name='poc_get']").val();if($(".myinput[name='poc_method']").val()==="GET"&&$(".myinput[name='poc_data']").val()!==""){t+='<code class="text-success">?'+encodeURI($(".myinput[name='poc_data']").val())+"</code>"}t+=' <code class="text-muted">HTTP/1.1</code>\n';var a=$(".myinput[name='opt_host']").val();var e=$(".myinput[name='opt_port']").val();if(a){t+='<strong class="text-warning">Host</strong>: '+a;if(e){t+=":"+e}t+="\n"}var n={};var i="";$(".headers").each(function(){if($(this).attr("placeholder")==="KEY"){i=$(this).val()}else if(i!==""){n[i]=$(this).val()}});for(var o in n){t+='<strong class="text-warning">'+o+"</strong>: "+n[o]+"\n"}if($(".myinput[name='poc_method']").val()==="POST"){t+='\n<code class="text-success">'+encodeURI($(".myinput[name='poc_data']").val())+"</code>"}t+="</pre>";$("#preview").html(t)}function startSubmit(){var t={};var a="";$(".headers").each(function(){if($(this).attr("placeholder")==="KEY"){a=$(this).val()}else if(a!==""){t[a]=$(this).val()}});var e={};$(".myinput").each(function(){if($(this).val()&&$(this).attr("name")){e[$(this).attr("name")]=$(this).val()}});e["info_cms"]=e["info_cms"].toLowerCase();if(e["poc_method"]==="POST"){var n={};var a=(e["poc_data"]||"").split("&");for(var i in a){var o=a[i].split("=");n[o[0]]=a[i].replace(o[0]+"=","")}e["poc_data"]=JSON.stringify(n)}else{if(e["poc_data"]){e["poc_get"]+="?"+e["poc_data"]}e["poc_data"]=""}e["headers"]=JSON.stringify(t);if(e["headers"]==="{}"){e["headers"]=""}submit.socket.emit("submit",e)}$(document).ready(function(){toastr.info("连接服务器中..","Info");disabledInput();submit.socket=io.connect(submit.server);submit.socket.on("connect",function(){toastr.success("连接服务器成功!","Success");enabledInput()}).on("disconnect",function(){toastr.error("服务器断开连接!","Error");disabledInput()}).on("reconnecting",function(){toastr.warning("无法连接服务器","Warning");disabledInput()}).on("submit",function(t){submit.res=t.res;if(t.res){$("#submit_msg").html("感谢您的提交!<br>我们将在尽快审核通过后给予对应的金币奖励!")}else{$("#submit_msg").html("哎呀!提交出错啦!<br>"+t.msg)}$("#myModal").modal()});$("#myModal").on("hidden.bs.modal",function(t){submit.btn.button("reset");if(submit.res){location.reload()}});$(".myinput").tooltip();$(".myinput").change(function(t){preview()});$("#submit").click(function(){if(checkInput()){submit.btn=$(this).button("loading");startSubmit();localStorage["mst_author_name"]=$("input[name='author_id']").val();localStorage["mst_author_email"]=$("input[name='author_email']").val();localStorage["mst_author_blog"]=$("input[name='author_blog']").val()}else{toastr.warning("请填写完整必选项!","Warning")}});$(".mustinput").keydown(function(t){if(t.keyCode===13){$("#submit").click()}});$("input[name='author_id']").val(localStorage["mst_author_name"]||"");$("input[name='author_email']").val(localStorage["mst_author_email"]||"");$("input[name='author_blog']").val(localStorage["mst_author_blog"]||"")});
//# sourceMappingURL=submit.min.map
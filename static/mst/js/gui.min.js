(function(e){(function(e,t){t["true"]=e;var i={base:{use:function(e){var t=document.createElement("script");t.type="text/javascript";t.onerror=function(t){e.error(t)};if(t.readyState){t.onreadystatechange=function(){if(["loaded","complete"].indexOf(t.readyState)>-1){e.success()}}}else{t.onload=function(){e.success()}}t.src=e.url||"";document.getElementsByTagName("head")[0].appendChild(t)},lenObj:function(e){var t=0;for(var i in e){t++}return t},bfb:function(e,t){return(Math.round(e/t*1e4)/100).toString()+"%"},local:{clear:function(){localStorage["mst_login_user"]="";localStorage["mst_login_pass"]=""},save:function(e,t){localStorage["mst_login_user"]=e;localStorage["mst_login_pass"]=t},user:localStorage["mst_login_user"]||"",pass:localStorage["mst_login_pass"]||""},openUrl:function(e){var t=e.opts_port===443?"https://":"http://";t+=e.opts_host;t+=e.opts_port===80||e.opts_port===443?"":":"+e.opts_port;window.open(t+e.opts_path,"_blank")},xstr:function(e){var t=/^[a-zA-Z0-9\.@]+$/;return t.test(e)},xint:function(e){var t=/^[0-9]+$/;return t.test(e)},xpat:function(e){var t=/^[a-zA-Z0-9\.@\-_\/#\?&=!]+$/;return t.test(e)}},cache:{user:{},category:{},pocs:{},tasks:{}},server:{socket:null,host:mst_config_server,send:function(e,t){this.socket.emit(e,t)}}};toastr.options={closeButton:true,debug:false,positionClass:"toast-bottom-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};$(function(){w2popup.lock("加载中..",true);$("body").css({"background-image":"url(/static/mst/img/bg"+Math.round(Math.random()*24)+".jpg)"});if(!w2ui.login){$().w2form({name:"login",style:"border: 0px; background-color: transparent;",formHTML:'<div class="w2ui-page page-0">'+'	<div class="w2ui-field">'+"		<label>帐号:</label>"+"		<div>"+'		   <input name="username" type="text" maxlength="10" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>密码:</label>"+"		<div>"+'			<input name="password" type="password" maxlength="20" style="width: 150px"/>'+"		</div>"+"	</div>"+"</div>"+'<div class="w2ui-buttons">'+'	<button class="btn" name="reset">重置</button>'+'	<button class="btn btn-green" name="login">登录</button>'+"</div>",fields:[{field:"username",type:"text",required:true},{field:"password",type:"password",required:true}],record:{username:i.base.local.user,password:i.base.local.pass},actions:{login:function(){i.server.send("init",{user:this.record.username,pass:this.record.password});w2popup.lock("验证用户中..",true);i.base.local.save(this.record.username,this.record.password)},reset:function(){this.clear();i.base.local.clear()}}})}w2popup.open({title:"用户登录",width:400,height:200,showClose:false,keyboard:false,modal:true,body:'<div id="login" style="width: 100%; height: 100%;"></div>',style:"padding: 15px 0px 0px 0px",onOpen:function(e){e.onComplete=function(){$("#w2ui-popup #login").w2render("login");$("#password").keyup(function(e){if(e.keyCode===13){w2ui.login.action("login")}})}}});w2popup.unlock();i.server.socket=io.connect(i.server.host);i.server.socket.on("connect",function(){toastr.success("连接服务器成功","Success");if(i.base.local.user!==""&&i.base.local.pass!==""){i.server.send("init",{user:i.base.local.user,pass:i.base.local.pass})}$("#username").attr("disabled",false);$("#password").attr("disabled",false)}).on("disconnect",function(){toastr.error("服务器断开连接!","Error");setTimeout(function(){location.reload()},1e3)}).on("reconnecting",function(){toastr.warning("无法连接服务器!","Warning");$("#username").attr("disabled","disabled");$("#password").attr("disabled","disabled");$("button[name='login']").attr("disabled","disabled");$("button[name='reset']").attr("disabled","disabled")}).on("init",function(e){w2popup.unlock();if(e.login){i.cache.pocs=e.pocs||{};i.cache.tasks=e.task||{};i.cache.user=e.user||{};i.cache.admin=e.admin||{};for(var t in i.cache.pocs){var a=t.match(/[-]([\s\S]+)[-]/)[1];i.cache.category[a]=i.cache.category[a]||[];i.cache.category[a].push(i.cache.pocs[t])}var s=[];s.push({id:"pocs_all",text:"全部分类",icon:"fa-tags",count:0,selected:true});for(var t in i.cache.category){s.push({id:"pocs_"+t,text:t,icon:"fa-tag",count:i.cache.category[t].length});s[0].count+=i.cache.category[t].length}var o=[];for(var t in i.cache.tasks){var n=i.cache.tasks[t];if(typeof n==="object"&&n!==null){o.push({id:"tasks_"+n.info.id,text:"TASK:"+n.info.id,icon:"fa-th-list",count:i.base.bfb(n.progress.now,n.progress.all)})}}w2popup.close();toastr.success("用户( "+e.user.name+" )登录成功!","Success");var r={layout:{name:"layout",padding:0,panels:[{type:"left",size:250,resizable:true,minSize:200},{type:"main",minSize:800,overflow:"hidden"}]},sidebar:{name:"sidebar",nodes:[{id:"pocs",text:"漏洞列表",group:true,expanded:true,nodes:s},{id:"tasks",text:"任务列表",group:true,expanded:true,nodes:o},{id:"settings",text:"系统设置",group:true,expanded:true,nodes:[{id:"settings_home",text:"返回主页",icon:"fa-home"},{id:"settings_submit",text:"提交POC",icon:"fa-plus-sign"},{id:"settings_console",text:"终端模式",icon:"fa-retweet"},{id:"settings_user",text:"用户信息",icon:"fa-user"},{id:"settings_logout",text:"注销登录",icon:"fa-signout"}]}],onClick:function(e){var t=e.target.split("_");var a=0;switch(t[0]){case"pocs":w2ui.layout.content("main",w2ui.grid_pocs);var s=[];for(var o in i.cache.pocs){var n=i.cache.pocs[o];if(t[1]==="all"||o.indexOf(t[1])!==-1){s.push({recid:a,id:o,coin:n.info.coin,author:w2utils.encodeTags(n.info.author),modify:w2utils.encodeTags(n.info.modify),name:w2utils.encodeTags(n.info.name)});a++}}w2ui.grid_pocs.records=s;break;case"tasks":w2ui.layout.content("main",w2ui.grid_tasks);var r=i.cache.tasks[t[1]].scan;var d=i.cache.tasks[t[1]].time;var l=i.cache.tasks[t[1]].progress;var s=[];w2ui.grid_tasks_toolbar.set("task_time_create",{caption:d.create});w2ui.grid_tasks_toolbar.set("task_time_update",{caption:d.update});if(l.all===l.now){w2ui.grid_tasks_toolbar.enable("task_del")}else{w2ui.grid_tasks_toolbar.disable("task_del")}for(var o in r){var c=r[o];for(var p in c){var u={};if(c[p].res===true){u.msg="存在漏洞!";u.css="background-color: #FBFEC0; color: red"}else if(c[p].res===false){u.msg="没有漏洞!";u.css=""}else{u.msg="等待扫描完成..";u.css="background-color: #C2F5B4"}s.push({recid:a,pid:o,opts_host:c[p].opt.host,opts_port:c[p].opt.port,opts_path:c[p].opt.path,test_res:u.msg,style:u.css});a++}}w2ui.grid_tasks.records=s;break;case"settings":if(t[1]==="logout"){w2confirm({msg:"确定要注销吗?",title:"注销登录",width:300,height:150,yes_text:"确定",yes_class:"btn btn-red",yes_callBack:function(){i.base.local.clear();location.reload()},no_text:"取消"})}else if(t[1]==="user"){if(!w2ui.settings_user_form){$("#settings_user_form").w2form({name:"settings_user_form",style:"border: 0px; background-color: transparent;",formHTML:'<div class="w2ui-page page-0">'+'	<div class="w2ui-field">'+"		<label>用户名:</label>"+"		<div>"+'		   <input name="user_name" disabled type="text" maxlength="10" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>金币:</label>"+"		<div>"+'		   <input name="user_coin" disabled type="text" maxlength="10" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>邮箱:</label>"+"		<div>"+'			<input name="user_email" type="email" maxlength="50" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>博客:</label>"+"		<div>"+'			<input name="user_blog" type="email" maxlength="50" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>密码:</label>"+"		<div>"+'			<input name="user_pass" type="password" maxlength="20" style="width: 150px"/>'+"		</div>"+"	</div>"+"</div>"+'<div class="w2ui-buttons">'+'	<button class="btn" name="user_close">关闭</button>'+'	<button class="btn btn-orange" name="user_update">更新</button>'+"</div>",fields:[{field:"user_name",type:"text",required:false},{field:"user_coin",type:"text",required:false},{field:"user_email",type:"email",required:true},{field:"user_blog",type:"text",required:false},{field:"user_pass",type:"password",required:true}],record:{},actions:{},onChange:function(e){}})}w2ui.settings_user_form.record={user_name:i.cache.user.name,user_coin:i.cache.user.coin,user_email:i.cache.user.email,user_blog:i.cache.user.blog,user_pass:localStorage["mst_login_pass"]||""};w2ui.settings_user_form.actions={user_close:function(){w2popup.close()},user_update:function(){w2popup.lock("更新用户信息中..",true);i.server.send("user",{act:"update",pass:this.record.user_pass,email:this.record.user_email,blog:this.record.user_blog})}};w2popup.open({title:"用户信息",width:400,height:300,showMax:false,modal:true,style:"padding: 15px 0px 0px 0px",body:'<div id="settings_user_form" style="width: 100%; height: 100%;"></div>',onOpen:function(e){e.onComplete=function(){$("#w2ui-popup #settings_user_form").w2render("settings_user_form")}}})}else if(t[1]==="console"){location.href="/console/"}else if(t[1]==="submit"){window.open("/submit/","_blank")}else{location.href="../"}break;case"admin":switch(t[1]){case"pocs":w2ui.layout.content("main",w2ui.grid_admin_pocs);var s=[];for(var o in i.cache.admin.pocs){var n=i.cache.admin.pocs[o];s.push({recid:a,id:n.id,pid:w2utils.encodeTags(o),name:w2utils.encodeTags(n.info_name),desc:w2utils.encodeTags(n.info_desc),author:w2utils.encodeTags(n.author_name),modify:n.info_modify,verify:n.is_verify===1?"是":"否",style:n.is_verify===0?"background-color: #FAFEC0; color: rgb(255, 0, 165)":""});a++}w2ui.grid_admin_pocs.records=s;break;case"users":w2ui.layout.content("main",w2ui.grid_admin_users);var s=[];for(var o in i.cache.admin.users){var _=i.cache.admin.users[o];s.push({recid:a,uid:_.id,name:w2utils.encodeTags(_.name),email:w2utils.encodeTags(_.email),blog:w2utils.encodeTags(_.blog),coin:_.coin,style:_.admin===1?"background-color: #FEF1C0; color: rgb(255, 0, 0)":""});a++}w2ui.grid_admin_users.records=s;break;default:break}break;default:console.log(t[0]);break}}},grid_pocs:{name:"grid_pocs",show:{lineNumbers:true,selectColumn:true,footer:true,toolbar:true},multiSearch:false,columns:[{field:"id",caption:"漏洞ID",size:"200px",sortable:true},{field:"name",caption:"漏洞名称",size:"100%",min:200,sortable:true},{field:"coin",caption:"漏洞金币",size:"100px",sortable:true},{field:"author",caption:"提交作者",size:"150px",sortable:true},{field:"modify",caption:"提交时间",size:"150px",sortable:true}],records:[],searches:[{field:"name",caption:"漏洞名称",type:"text"},{field:"coin",caption:"漏洞金币",type:"text"},{field:"author",caption:"提交作者",type:"text"},{field:"modify",caption:"提交时间",type:"text"}],toolbar:{items:[{type:"break"},{type:"button",id:"poc_info",caption:"漏洞信息",icon:"fa-info-sign",disabled:true},{type:"break"},{type:"button",id:"poc_load",caption:"漏洞检测",icon:"fa-ok-sign",disabled:true},{type:"break"},{type:"button",id:"poc_task",caption:"添加任务",icon:"fa-plus-sign",disabled:true}],onClick:function(e,t){var a=w2ui.grid_pocs.getSelection();var s=a.length>0?w2ui.grid_pocs.get(a[0]).id:0;switch(e){case"poc_info":var o=i.cache.pocs[s].info;var n=o.reference.split(",");var r="";for(var d in n){r+='<a href="'+w2utils.encodeTags(n[d])+'" target="_blank">'+w2utils.encodeTags(n[d])+"</a><br>"}w2popup.open({title:'<span class="fa-info-sign"></span> 漏洞信息(<span class="text-danger">'+s+"</span>)",width:600,height:350,modal:true,style:"padding: 15px;margin-left: -20px",body:'<div id="poc_info" style="width: 100%; height: 100%;">										<dl class="dl-horizontal">											<dt>提交时间</dt><dd class="text-muted">'+o.modify+'</dd>											<dt>提交作者</dt><dd class="text-info">'+w2utils.encodeTags(o.author)+'</dd>											<dt>作者邮箱</dt><dd><a href="mailto:'+w2utils.encodeTags(o.author_eml)+'">'+w2utils.encodeTags(o.author_eml)+"</a></dd>											<dt>作者网站</dt><dd>"+(o.author_web?'<a href="'+w2utils.encodeTags(o.author_web)+'" target="_blank">'+w2utils.encodeTags(o.author_web)+"</a>":"(暂无)")+'</dd>											<dt>漏洞名称</dt><dd class="text-success">'+w2utils.encodeTags(o.name)+'</dd>											<dt>漏洞金币</dt><dd class="text-danger">'+o.coin+'</dd>											<dt>漏洞简介</dt><dd class="text-warning">'+w2utils.encodeTags(o.desc)+'</dd>											<dt>修复方案</dt><dd class="text-info">'+w2utils.encodeTags(o.fix||"暂无")+"</dd>											<dt>漏洞参考</dt><dd>"+r+"</dd>										</dl>										</div>",onOpen:function(e){e.onComplete=function(){}}});break;case"poc_load":if(i.cache.user.coin<i.cache.pocs[s].info.coin){toastr.warning("金币不足以加载此漏洞!","Warning");return false};var l=i.cache.pocs[s].opts;if(!w2ui.poc_load){$("#poc_load").w2form({name:"poc_load",style:"border: 0px; background-color: transparent;",formHTML:'<div class="w2ui-page page-0">'+'	<div class="w2ui-field">'+"		<label>地址:</label>"+"		<div>"+'		   <input name="poc_load_host" type="text" maxlength="100" style="width: 250px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>端口:</label>"+"		<div>"+'			<input name="poc_load_port" type="text" maxlength="20" style="width: 250px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>路径:</label>"+"		<div>"+'			<input name="poc_load_path" type="text" maxlength="20" style="width: 250px"/>'+"		</div>"+"	</div>"+"</div>"+'<div class="w2ui-buttons">'+'	<button class="btn" name="poc_load_reset">重置</button>'+'	<button class="btn btn-orange" name="poc_load_test">检测</button>'+"</div>",fields:[{field:"poc_load_host",type:"text",required:true},{field:"poc_load_port",type:"text",required:true},{field:"poc_load_path",type:"text",required:true}],record:{},actions:{}})};w2ui.poc_load.record={poc_load_host:localStorage["mst_opts_host"]||l.host,poc_load_port:l.port,poc_load_path:l.path};w2ui.poc_load.actions={poc_load_test:function(){w2popup.lock("检测中..",true);i.server.send("test",{name:s,opts:{host:this.record.poc_load_host,port:parseInt(this.record.poc_load_port),path:this.record.poc_load_path}});localStorage["mst_opts_host"]=this.record.poc_load_host},poc_load_reset:function(){this.clear();localStorage["mst_opts_host"]=""}};w2popup.open({title:'<span class="fa-ok-sign"></span> 漏洞检测(<span class="text-danger">'+s+"</span>)",width:500,height:250,modal:true,showMax:false,style:"padding: 15px 0px 0px 0px",body:'<div id="poc_load" style="width: 100%; height: 100%;"></div>',onOpen:function(e){e.onComplete=function(){$("#w2ui-popup #poc_load").w2render("poc_load")}}});break;case"poc_task":if(!w2ui.poc_task_toolbar){$().w2toolbar({name:"poc_task_toolbar",items:[{type:"button",id:"poc_task_toolbar_clear",caption:"清空",img:"fa-remove",hint:"清空内容"},{type:"break"},{type:"button",id:"poc_task_toolbar_add",caption:"添加",img:"fa-ok",hint:"添加任务"},{type:"break"},{type:"html",html:'<span class="text-info"><i class="fa-info-sign"></i> 提示: 每行一个选项，格式(host:port:path)，如(3asec.com:80:/)</span>'}],onClick:function(e){var t=$("#poc_task_opts").val();var a=w2ui.grid_pocs.getSelection();switch(e.target){case"poc_task_toolbar_clear":if(t===""){toastr.warning("没有可清空的内容!","Warning")}else{$("#poc_task_opts").val("");toastr.success("内容清空完毕!","Success")}break;case"poc_task_toolbar_add":var s=t.split("\n");var o=[];var n=[];for(var r in a){var d=w2ui.grid_pocs.get(a[r]).id;if(i.cache.user.coin>=i.cache.pocs[d].info.coin){n.push(d)}else{toastr.warning("金币不足以加载漏洞("+d+")!","Warning")}};for(var r in s){if(s[r]){var l=s[r].split(":");l[0]=i.base.xstr(l[0])?l[0]:false;if(l[0]){o.push({host:l[0],port:parseInt(l[1])||80,path:l[2]||"/"})}else{toastr.warning("格式输入有误("+l[0]+")!","Warning")}}}if(o.length>0&&n.length>0){w2popup.lock("添加任务中..",true);i.server.send("task",{act:"add",poc:n,opt:o});localStorage["mst_task_opts"]=t}else{toastr.warning("没有可添加的任务列表!","Warning")}break;default:break}}})};w2popup.open({title:'<span class="fa-plus-sign"></span> 扫描任务('+a.length+")",width:600,height:400,modal:true,showMax:true,style:"padding: 0px",body:'<div id="poc_task" style="width: 100%; height: 100%;">										<div id="poc_task_toolbar" style="padding: 4px; border: 1px solid silver"></div>										<textarea id="poc_task_opts" style="width: 100%; height: 100%;outline: none;border-radius: 0;"></textarea>										</div>',onOpen:function(e){e.onComplete=function(){$("#w2ui-popup #poc_task_toolbar").w2render("poc_task_toolbar");$("#poc_task_opts").val(localStorage["mst_task_opts"]||"");toastr.info("请添加要扫描的配置列表","Info")}}});break;default:break}}},onSelect:function(e){e.onComplete=function(){var e=w2ui.grid_pocs.getSelection();var t=["poc_info","poc_load"];var i=["poc_task"];if(e.length===0){for(var a in t){this.toolbar.disable(t[a])}for(var a in i){this.toolbar.disable(i[a])}}else if(e.length===1){for(var a in t){this.toolbar.enable(t[a])}for(var a in i){this.toolbar.enable(i[a])}}else{for(var a in t){this.toolbar.disable(t[a])}for(var a in i){this.toolbar.enable(i[a])}}}},onUnselect:function(e){this.onSelect(e)},onRefresh:function(e){w2ui.layout.lock("main","加载数据中..",true);e.onComplete=function(){w2ui.layout.unlock("main")}},onDblClick:function(e){w2ui.grid_pocs_toolbar.click("poc_load")},onContextMenu:function(e){w2ui.grid_pocs_toolbar.click("poc_task")}},grid_tasks:{name:"grid_tasks",show:{lineNumbers:true,footer:true,toolbar:true},multiSearch:false,columns:[{field:"pid",caption:"漏洞ID",size:"200px",sortable:true},{field:"opts_host",caption:"扫描地址",size:"300px",sortable:true},{field:"opts_port",caption:"扫描端口",size:"100px",sortable:true},{field:"opts_path",caption:"扫描路径",size:"300px",sortable:true},{field:"test_res",caption:"扫描结果",size:"100%",min:100,sortable:true}],records:[],searches:[{field:"opts_host",caption:"扫描地址",type:"text"},{field:"opts_port",caption:"扫描端口",type:"text"},{field:"opts_path",caption:"扫描路径",type:"text"},{field:"test_res",caption:"扫描结果",type:"text"}],toolbar:{items:[{type:"break"},{type:"button",id:"task_del",caption:"删除任务",icon:"fa-trash",disabled:true},{type:"spacer"},{type:"radio",id:"task_time_create",caption:"创建时间",checked:true,icon:"fa-time"},{type:"break"},{type:"radio",id:"task_time_update",caption:"更新时间",icon:"fa-time"}],onClick:function(e,t){var a=parseInt(w2ui.sidebar.selected.replace("tasks_",""));switch(e){case"task_del":w2confirm({msg:"确定删除任务( "+a+" )?",title:"删除任务",width:300,height:150,yes_text:"确定",yes_class:"btn btn-red",yes_callBack:function(){i.server.send("task",{act:"del",tid:a})},no_text:"取消"});break;case"task_time_update":toastr.info("任务更新时间!","Info");break;case"task_time_create":toastr.info("任务创建时间!","Info");break;default:console.log(e);break}}},onRefresh:function(e){w2ui.grid_pocs.onRefresh(e)},onDblClick:function(e){i.base.openUrl(w2ui.grid_tasks.get(e.recid))},onContextMenu:function(e){}},grid_admin_pocs:{name:"grid_admin_pocs",show:{lineNumbers:true,selectColumn:true,footer:true,toolbar:true},multiSearch:false,columns:[{field:"id",caption:"排序ID"},{field:"pid",caption:"漏洞ID",size:"15%",sortable:true},{field:"name",caption:"漏洞名称",size:"25%",min:200,sortable:true},{field:"desc",caption:"漏洞简介",size:"30%",sortable:true},{field:"author",caption:"提交作者",size:"10%",sortable:true},{field:"verify",caption:"是否审核",size:"10%",sortable:true},{field:"modify",caption:"提交时间",size:"15%",sortable:true}],records:[],searches:[{field:"pid",caption:"漏洞ID",type:"text"},{field:"name",caption:"漏洞名称",type:"text"},{field:"desc",caption:"漏洞简介",type:"text"},{field:"author",caption:"提交作者",type:"text"},{field:"modify",caption:"提交时间",type:"text"},{field:"verify",caption:"是否审核",type:"text"}],toolbar:{items:[{type:"break"},{type:"button",id:"admin_poc_update",caption:"编辑漏洞",icon:"fa-info-sign",disabled:true},{type:"break"},{type:"button",id:"admin_poc_del",caption:"删除漏洞",icon:"fa-remove-sign",disabled:true},{type:"break"},{type:"button",id:"admin_poc_verify",caption:"审核漏洞",icon:"fa-ok",disabled:true},{type:"break"},{type:"button",id:"admin_poc_noverify",caption:"取消审核",icon:"fa-remove",disabled:true},{type:"break"},{type:"button",id:"admin_poc_test",caption:"检测漏洞",icon:"fa-plus-sign",disabled:true}],onClick:function(e,t){var a=w2ui.grid_admin_pocs.getSelection();switch(e){case"admin_poc_update":var s={};for(var o in i.cache.admin.pocs){if(i.cache.admin.pocs[o].id===w2ui.grid_admin_pocs.get(a[0]).id){s=i.cache.admin.pocs[o]}}console.log(s);if(!w2ui.admin_poc_update){$("#admin_poc_update").w2form({name:"admin_poc_update",style:"border: 0px; background-color: transparent;",formHTML:'<div class="w2ui-page page-0">'+'	<div class="w2ui-field">'+"		<label>漏洞ID:</label>"+"		<div>"+'		   <input name="pid" type="text" maxlength="20" style="width: 400px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>漏洞名称:</label>"+"		<div>"+'		   <input name="info_name" type="text" maxlength="100" style="width: 400px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>漏洞简介:</label>"+"		<div>"+'			<textarea name="info_desc" type="text" style="width: 400px; height: 80px; resize: none"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>修复方案:</label>"+"		<div>"+'			<textarea name="info_fix" type="text" style="width: 400px; height: 80px; resize: none"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>参考链接:</label>"+"		<div>"+'			<input name="info_reference" type="text" maxlength="20" style="width: 400px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>提交方式:</label>"+"		<div>"+'			<input name="poc_method" type="text" maxlength="5"  style="width: 400px !important;">'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>页面编码:</label>"+"		<div>"+'			<input name="poc_encode" type="text" maxlength="20" style="width: 400px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>正则匹配:</label>"+"		<div>"+'			<input name="poc_reg" type="text" maxlength="20" style="width: 400px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>GET数据:</label>"+"		<div>"+'			<textarea name="poc_get" type="text" style="width: 400px; height: 80px; resize: none"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>POST数据:</label>"+"		<div>"+'			<textarea name="poc_data" type="text" style="width: 400px; height: 80px; resize: none"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>头信息:</label>"+"		<div>"+'			<textarea name="poc_headers" type="text" style="width: 400px; height: 80px; resize: none"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>测试地址:</label>"+"		<div>"+'			<input name="opts_host" type="text" maxlength="20" style="width: 400px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>测试端口:</label>"+"		<div>"+'			<input name="opts_port" type="text" maxlength="20" style="width: 400px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>测试路径:</label>"+"		<div>"+'			<input name="opts_path" type="text" maxlength="20" style="width: 400px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>作者ID:</label>"+"		<div>"+'			<input name="author_name" type="text" maxlength="20" style="width: 400px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>作者邮箱:</label>"+"		<div>"+'			<input name="author_email" type="text" maxlength="20" style="width: 400px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>作者博客:</label>"+"		<div>"+'			<input name="author_blog" type="text" maxlength="20" style="width: 400px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>漏洞金币:</label>"+"		<div>"+'			<input name="info_coin" type="text" maxlength="20" style="width: 400px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>是否审核:</label>"+"		<div>"+'			<input name="is_verify" type="text" maxlength="20" style="width: 400px"/>'+"		</div>"+"	</div>"+"</div>"+'<div class="w2ui-buttons">'+'	<button class="btn" name="poc_close">关闭</button>'+'	<button class="btn btn-orange" name="poc_update">更新</button>'+"</div>",fields:[{field:"pid",type:"text",required:true},{field:"info_name",type:"text",required:true},{field:"info_desc",type:"text"},{field:"info_fix",type:"text"},{field:"info_reference",type:"text"},{field:"poc_method",type:"list",required:true,options:{items:["GET","POST"]}},{field:"poc_encode",type:"text"},{field:"poc_reg",type:"text",required:true},{field:"poc_get",type:"text",required:true},{field:"poc_data",type:"text"},{field:"poc_headers",type:"text"},{field:"opts_host",type:"text"},{field:"opts_port",type:"text"},{field:"opts_path",type:"text"},{field:"author_name",type:"text",required:true},{field:"author_email",type:"email",required:true},{field:"author_blog",type:"text"},{field:"info_coin",type:"text",required:true},{field:"is_verify",type:"list",required:true,options:{items:["0","1"]}}],record:{},actions:{},onChange:function(e){}})};w2ui.admin_poc_update.record={pid:s.pid,info_name:s.info_name,info_desc:s.info_desc,info_fix:s.info_fix,info_reference:s.info_reference,poc_method:s.poc_method,poc_encode:s.poc_encode,poc_reg:s.poc_reg,poc_get:s.poc_get,poc_data:s.poc_data,poc_headers:s.poc_headers,opts_host:s.opts_host,opts_port:s.opts_port,opts_path:s.opts_path,author_name:s.author_name,author_email:s.author_email,author_blog:s.author_blog,info_coin:s.info_coin,is_verify:s.is_verify};w2ui.admin_poc_update.actions={poc_close:function(){w2popup.close()},poc_update:function(){w2popup.lock("更新POC信息中..",true);i.server.send("admin",{act:"updatepoc",id:s.id,pid:this.record.pid,info_name:this.record.info_name,info_desc:this.record.info_desc,info_fix:this.record.info_fix,info_reference:this.record.info_reference,poc_method:this.record.poc_method.text,poc_encode:this.record.poc_encode,poc_reg:this.record.poc_reg,poc_get:this.record.poc_get,poc_data:this.record.poc_data,poc_headers:this.record.poc_headers,opts_host:this.record.opts_host,opts_port:this.record.opts_port,opts_path:this.record.opts_path,author_name:this.record.author_name,author_email:this.record.author_email,author_blog:this.record.author_blog,info_coin:this.record.info_coin,is_verify:this.record.is_verify.text})}};w2popup.open({title:"编辑POC",width:666,height:520,showMax:false,modal:true,style:"padding: 5px 0px 0px 0px",body:'<div id="admin_poc_update" style="width: 100%; height: 100%;"></div>',onOpen:function(e){e.onComplete=function(){$("#w2ui-popup #admin_poc_update").w2render("admin_poc_update")}}});break;case"admin_poc_del":w2confirm({msg:"确定要删除所选POC?",title:"删除POC",width:300,height:150,yes_text:"确定",yes_class:"btn btn-red",yes_callBack:function(){for(var e=0;e<a.length;e++){var t=w2ui.grid_admin_pocs.get(a[e]);i.server.send("admin",{act:"delpoc",id:t.id})}},no_text:"取消"});break;case"admin_poc_verify":w2confirm({msg:"确定要审核所选POC?",title:"审核POC",width:300,height:150,yes_text:"确定",yes_class:"btn btn-orange",yes_callBack:function(){for(var e=0;e<a.length;e++){var t=w2ui.grid_admin_pocs.get(a[e]);i.server.send("admin",{act:"verifypoc",id:t.id})}},no_text:"取消"});break;case"admin_poc_noverify":w2confirm({msg:"确定取消审核所选POC?",title:"取消审核POC",width:300,height:150,yes_text:"确定",yes_class:"btn btn-blue",yes_callBack:function(){for(var e=0;e<a.length;e++){var t=w2ui.grid_admin_pocs.get(a[e]);i.server.send("admin",{act:"noverifypoc",id:t.id})}},no_text:"取消"});break;case"admin_poc_test":var n=w2ui.grid_admin_pocs.get(a).pid;var s=i.cache.admin.pocs[n];if(!w2ui.poc_load){$("#poc_load").w2form({name:"poc_load",style:"border: 0px; background-color: transparent;",formHTML:'<div class="w2ui-page page-0">'+'	<div class="w2ui-field">'+"		<label>地址:</label>"+"		<div>"+'		   <input name="poc_load_host" type="text" maxlength="100" style="width: 250px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>端口:</label>"+"		<div>"+'			<input name="poc_load_port" type="text" maxlength="20" style="width: 250px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>路径:</label>"+"		<div>"+'			<input name="poc_load_path" type="text" maxlength="20" style="width: 250px"/>'+"		</div>"+"	</div>"+"</div>"+'<div class="w2ui-buttons">'+'	<button class="btn" name="poc_load_reset">重置</button>'+'	<button class="btn btn-orange" name="poc_load_test">检测</button>'+"</div>",fields:[{field:"poc_load_host",type:"text",required:true},{field:"poc_load_port",type:"text",required:true},{field:"poc_load_path",type:"text",required:true}],record:{},actions:{}})};w2ui.poc_load.record={poc_load_host:localStorage["mst_opts_host"]||s.opts_host,poc_load_port:s.opts_port,poc_load_path:s.opts_path};w2ui.poc_load.actions={poc_load_test:function(){w2popup.lock("检测中..",true);i.server.send("test",{name:n,opts:{host:this.record.poc_load_host,port:parseInt(this.record.poc_load_port),path:this.record.poc_load_path}});localStorage["mst_opts_host"]=this.record.poc_load_host},poc_load_reset:function(){this.clear();localStorage["mst_opts_host"]=""}};w2popup.open({title:'<span class="fa-ok-sign"></span> 漏洞检测(<span class="text-danger">'+n+"</span>)",width:500,height:250,modal:true,showMax:false,style:"padding: 15px 0px 0px 0px",body:'<div id="poc_load" style="width: 100%; height: 100%;"></div>',onOpen:function(e){e.onComplete=function(){$("#w2ui-popup #poc_load").w2render("poc_load")}}});break;default:break}}},onSelect:function(e){e.onComplete=function(){var e=w2ui.grid_admin_pocs.getSelection();var t=["admin_poc_update","admin_poc_test"];var i=["admin_poc_del","admin_poc_verify","admin_poc_noverify"];if(e.length===0){for(var a in t){this.toolbar.disable(t[a])}for(var a in i){this.toolbar.disable(i[a])}}else if(e.length===1){for(var a in t){this.toolbar.enable(t[a])}for(var a in i){this.toolbar.enable(i[a])}}else{for(var a in t){this.toolbar.disable(t[a])}for(var a in i){this.toolbar.enable(i[a])}}}},onUnselect:function(e){this.onSelect(e)},onRefresh:function(e){w2ui.layout.lock("main","加载数据中..",true);e.onComplete=function(){w2ui.layout.unlock("main")}},onDblClick:function(e){w2ui.grid_admin_pocs.click("admin_poc_test")},onContextMenu:function(e){w2ui.grid_admin_pocs.click("admin_poc_update")}},grid_admin_users:{name:"grid_admin_users",show:{lineNumbers:true,selectColumn:true,footer:true,toolbar:true},multiSearch:false,columns:[{field:"uid",caption:"用户ID"},{field:"name",caption:"用户名称",size:"25%",min:200,sortable:true},{field:"email",caption:"用户邮箱",size:"30%",sortable:true},{field:"blog",caption:"用户网站",size:"35%",sortable:true},{field:"coin",caption:"用户金币",size:"15%",sortable:true}],records:[],searches:[{field:"name",caption:"用户名称",type:"text"},{field:"email",caption:"用户邮箱",type:"text"},{field:"blog",caption:"用户网站",type:"text"},{field:"coin",caption:"用户金币",type:"text"}],toolbar:{items:[{type:"break"},{type:"button",id:"admin_user_update",caption:"更新信息",icon:"fa-info-sign",disabled:true},{type:"break"},{type:"button",id:"admin_user_del",caption:"删除用户",icon:"fa-remove-sign",disabled:true},{type:"break"},{type:"button",id:"admin_user_add",caption:"添加用户",icon:"fa-plus-sign"}],onClick:function(e,t){var a=w2ui.grid_admin_users.getSelection();switch(e){case"admin_user_update":var s=w2ui.grid_admin_users.get(a[0]);if(!w2ui.admin_user_update){$("#admin_user_update").w2form({name:"admin_user_update",style:"border: 0px; background-color: transparent;",formHTML:'<div class="w2ui-page page-0">'+'	<div class="w2ui-field">'+"		<label>用户名:</label>"+"		<div>"+'		   <input name="user_name" type="text" maxlength="10" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>金币:</label>"+"		<div>"+'		   <input name="user_coin" type="text" maxlength="10" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>邮箱:</label>"+"		<div>"+'			<input name="user_email" type="email" maxlength="50" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>博客:</label>"+"		<div>"+'			<input name="user_blog" type="email" maxlength="50" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>密码:</label>"+"		<div>"+'			<input name="user_pass" type="password" maxlength="20" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>管理员:</label>"+"		<div>"+'			<input name="user_admin" type="text" maxlength="5"  style="width: 150px !important;">'+"		</div>"+"	</div>"+"</div>"+'<div class="w2ui-buttons">'+'	<button class="btn" name="user_close">关闭</button>'+'	<button class="btn btn-orange" name="user_update">更新</button>'+"</div>",fields:[{field:"user_name",type:"text",required:true},{field:"user_coin",type:"text",required:true},{field:"user_email",type:"email",required:true},{field:"user_blog",type:"text",required:false},{field:"user_pass",type:"password",required:true},{field:"user_admin",type:"list",required:false,options:{items:["0","1"]}}],record:{},actions:{},onChange:function(e){}})
};w2ui.admin_user_update.record={user_name:s.name,user_email:s.email,user_coin:s.coin,user_blog:s.blog,user_admin:s.style===""?"0":"1"};w2ui.admin_user_update.actions={user_close:function(){w2popup.close()},user_update:function(){w2popup.lock("更新用户信息中..",true);i.server.send("admin",{act:"updateuser",uid:s.uid,name:this.record.user_name,coin:this.record.user_coin,pass:this.record.user_pass,email:this.record.user_email,blog:this.record.user_blog,admin:this.record.user_admin})}};w2popup.open({title:"更新用户",width:400,height:320,showMax:false,modal:true,style:"padding: 5px 0px 0px 0px",body:'<div id="admin_user_update" style="width: 100%; height: 100%;"></div>',onOpen:function(e){e.onComplete=function(){$("#w2ui-popup #admin_user_update").w2render("admin_user_update")}}});break;case"admin_user_del":w2confirm({msg:"确定要删除所选用户?",title:"删除用户",width:300,height:150,yes_text:"确定",yes_class:"btn btn-red",yes_callBack:function(){for(var e in a){var t=w2ui.grid_admin_users.get(a[e]);i.server.send("admin",{act:"deluser",uid:t.uid})}},no_text:"取消"});break;case"admin_user_add":if(!w2ui.admin_user_add_form){$("#admin_user_add_form").w2form({name:"admin_user_add_form",style:"border: 0px; background-color: transparent;",formHTML:'<div class="w2ui-page page-0">'+'	<div class="w2ui-field">'+"		<label>用户名:</label>"+"		<div>"+'		   <input name="user_name" type="text" maxlength="10" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>金币:</label>"+"		<div>"+'		   <input name="user_coin" type="text" maxlength="10" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>邮箱:</label>"+"		<div>"+'			<input name="user_email" type="email" maxlength="50" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>博客:</label>"+"		<div>"+'			<input name="user_blog" type="email" maxlength="50" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>密码:</label>"+"		<div>"+'			<input name="user_pass" type="password" maxlength="20" style="width: 150px"/>'+"		</div>"+"	</div>"+'	<div class="w2ui-field">'+"		<label>管理员:</label>"+"		<div>"+'			<input name="user_admin" type="text" maxlength="5"  style="width: 150px !important;">'+"		</div>"+"	</div>"+"</div>"+'<div class="w2ui-buttons">'+'	<button class="btn" name="user_close">关闭</button>'+'	<button class="btn btn-orange" name="user_add">添加</button>'+"</div>",fields:[{field:"user_name",type:"text",required:true},{field:"user_coin",type:"text",required:true},{field:"user_email",type:"email",required:true},{field:"user_blog",type:"text",required:false},{field:"user_pass",type:"password",required:true},{field:"user_admin",type:"list",required:false,options:{items:["0","1"]}}],record:{user_admin:"0",user_coin:"0",user_blog:"http://"},actions:{},onChange:function(e){}})};w2ui.admin_user_add_form.actions={user_close:function(){w2popup.close()},user_add:function(){w2popup.lock("添加用户信息中..",true);i.server.send("admin",{act:"adduser",name:this.record.user_name,coin:this.record.user_coin,pass:this.record.user_pass,email:this.record.user_email,blog:this.record.user_blog,admin:this.record.user_admin})}};w2popup.open({title:"添加用户",width:400,height:320,showMax:false,modal:true,style:"padding: 5px 0px 0px 0px",body:'<div id="admin_user_add_form" style="width: 100%; height: 100%;"></div>',onOpen:function(e){e.onComplete=function(){$("#w2ui-popup #admin_user_add_form").w2render("admin_user_add_form")}}});break;default:break}}},onSelect:function(e){e.onComplete=function(){var e=w2ui.grid_admin_users.getSelection();var t="admin_user_update";var i="admin_user_del";switch(e.length){case 0:this.toolbar.disable(t);this.toolbar.disable(i);break;case 1:this.toolbar.enable(t);this.toolbar.enable(i);break;default:this.toolbar.disable(t);this.toolbar.enable(i);break}}},onUnselect:function(e){this.onSelect(e)},onRefresh:function(e){w2ui.layout.lock("main","加载数据中..",true);e.onComplete=function(){w2ui.layout.unlock("main")}},onDblClick:function(e){w2ui.grid_admin_users_toolbar.click("admin_user_update")},onContextMenu:function(e){w2ui.grid_admin_users_toolbar.click("admin_user_del")}}};if(i.cache.user.admin===1){r.sidebar.nodes.push({id:"admin",text:"后台管理",group:true,expanded:true,nodes:[{id:"admin_pocs",text:"POC管理",icon:"fa-th-list",count:i.base.lenObj(i.cache.admin.pocs)},{id:"admin_users",text:"用户管理",icon:"fa-user",count:i.base.lenObj(i.cache.admin.users)}]})}$("#main").w2layout(r.layout);w2ui.layout.content("left",$().w2sidebar(r.sidebar));w2ui.layout.content("main",$().w2grid(r.grid_pocs));$().w2grid(r.grid_tasks);$().w2grid(r.grid_admin_pocs);$().w2grid(r.grid_admin_users);w2ui.sidebar.click("pocs_all")}else{i.base.local.clear();toastr.warning("用户登录失败!","Warning")}}).on("task",function(e){switch(e.act){case"del":if(e.del){toastr.success("任务( "+e.tid+" )删除成功!","Success");i.cache.tasks=e.task;w2ui.sidebar.remove("tasks_"+e.tid);w2ui.sidebar.click("pocs_all")}else{toastr.error("任务( "+e.tid+" )删除失败!","Error")}break;case"add":if(e.add){toastr.success("任务("+e.tid+")添加成功!","Success");w2popup.message({width:350,height:150,html:'<div style="padding: 30px; text-align: center"><p class="text-success"><i class="glyphicon glyphicon-ok-sign"></i> 任务添加成功!是否继续添加?</p><hr><div class="w2ui-buttons"><button class="btn btn-red" id="poc_task_btn_no">取消</button><button class="btn btn-green" id="poc_task_btn_ok">确定</button></div></div>',onOpen:function(){$("#poc_task_btn_no").click(function(){w2popup.close()});$("#poc_task_btn_ok").click(function(){w2popup.message();$("#poc_task_opts").val("")})}});i.cache.tasks=e.task;w2ui.sidebar.add("tasks",{id:"tasks_"+e.tid,text:"TASK:"+e.tid,icon:"fa-th-list",count:"0%"})}else{toastr.error("任务("+e.tid+")添加失败!","Error")}w2popup.unlock();break;case"res":i.cache.tasks[e.res.info.id]=e.res;var t="tasks_"+e.res.info.id;w2ui.sidebar.set("tasks",t,{count:i.base.bfb(e.res.progress.now,e.res.progress.all)});if(w2ui.sidebar.selected===t){w2ui.sidebar.click(t)};if(e.res.progress.now===e.res.progress.all){toastr.info("任务("+e.res.info.id+")扫描完成!","Info",{timeOut:"15000",onclick:function(){w2ui.sidebar.click(t)}})};break;default:break}}).on("test",function(e){if(e.result){toastr.info("漏洞("+e.name+")存在!","Info");var t=i.cache.pocs[e.name]||i.cache.admin.pocs[e.name];var a=(i.cache.pocs[e.name]?i.cache.pocs[e.name].info.reference:i.cache.admin.pocs[e.name].info_reference).split(",");var s="";for(var o in a){s+='<a href="'+a[o]+'" target="_blank">'+a[o]+"</a> "}w2popup.message({width:400,height:200,html:'<div style="padding: 15px;">				<p class="text-danger"><i class="glyphicon glyphicon-warning-sign"></i> 发现漏洞! 赶紧修复! </p>				<p class="text-info"><i class="glyphicon glyphicon-wrench"></i> 修复方案:				<span class="text-success">'+(i.cache.pocs[e.name]?i.cache.pocs[e.name].info.fix:i.cache.admin.pocs[e.name].info_fix)+'</span></p>				<p class="text-info"><i class="glyphicon glyphicon-link"></i> 漏洞参考: '+s+'</p>				</div>				<div align="center"><button class="btn btn-green" onClick="w2popup.message();">确定</button></div>'})}else{toastr.warning("漏洞("+e.name+")不存在!","Warning");w2popup.message({width:250,height:100,hideOnClick:true,html:'<div style="padding: 35px; text-align: center">				<p class="text-success"><i class="glyphicon glyphicon-ok-circle"></i> 不存在此漏洞! </p>				</div>'})}w2popup.unlock()}).on("user",function(e){switch(e.act){case"update":if(e.msg===true){toastr.success("更新用户信息成功!","Success");i.cache.user=e.row;w2popup.close()}else{toastr.error("更新用户信息失败!<br>错误信息:"+e.msg,"Error")}w2popup.unlock();break;default:break}}).on("admin",function(e){switch(e.act){case"deluser":if(e.err){toastr.error("删除用户("+e.uid+")失败!<br>"+e.err,"Error")}else{toastr.success("删除用户("+e.uid+")成功!","Success");i.cache.admin.users=e.users;w2ui.sidebar.set("admin_users",{count:i.base.lenObj(i.cache.admin.users)});w2ui.sidebar.click("admin_users")}break;case"adduser":if(e.add){toastr.success("添加用户成功!","Success");w2popup.close();i.cache.admin.users=e.users;w2ui.sidebar.set("admin_users",{count:i.base.lenObj(i.cache.admin.users)});w2ui.sidebar.click("admin_users")}else{toastr.error("添加用户失败!<br>"+e.msg,"Error")}w2popup.unlock();break;case"updateuser":console.log(e);if(e.msg===true){toastr.success("更新用户成功!","Success");w2popup.close();i.cache.admin.users=e.users;w2ui.sidebar.set("admin_users",{count:i.base.lenObj(i.cache.admin.users)});w2ui.sidebar.click("admin_users")}else{toastr.error("更新用户失败!<br>"+e.msg,"Error")}w2popup.unlock();break;case"delpoc":if(e.del===true){toastr.success("删除POC("+e.id+")成功!","Success");i.cache.admin.pocs=e.pocs;w2ui.sidebar.set("admin_pocs",{count:i.base.lenObj(i.cache.admin.pocs)});w2ui.sidebar.click("admin_pocs")}else{toastr.error("删除POC("+e.id+")失败!<br>"+e.err,"Error")}break;case"verifypoc":if(e.err){toastr.error("审核POC("+e.id+")失败!<br>"+e.err,"Error")}else{toastr.success("审核POC("+e.id+")成功!","Success");i.cache.admin.pocs=e.pocs;w2ui.sidebar.set("admin_pocs",{count:i.base.lenObj(i.cache.admin.pocs)});w2ui.sidebar.click("admin_pocs")}break;case"noverifypoc":if(e.err){toastr.error("取消审核POC("+e.id+")失败!<br>"+e.err,"Error")}else{toastr.success("取消审核POC("+e.id+")成功!","Success");i.cache.admin.pocs=e.pocs;w2ui.sidebar.set("admin_pocs",{count:i.base.lenObj(i.cache.admin.pocs)});w2ui.sidebar.click("admin_pocs")}break;case"updatepoc":w2popup.unlock();if(e.err){toastr.error("更新POC("+e.id+")失败!<br>"+e.err,"Error")}else{toastr.success("更新POC("+e.id+")成功!","Success");i.cache.admin.pocs=e.pocs;w2ui.sidebar.set("admin_pocs",{count:i.base.lenObj(i.cache.admin.pocs)});w2ui.sidebar.click("admin_pocs");w2popup.close()}break}})})})({},function(){return this}())})();
//# sourceMappingURL=gui.min.map
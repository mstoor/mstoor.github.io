(function(t){(function(t,e){e["true"]=t;var n={server:mst_config_server,socket:null,btn:null,res:false,tmp:{name:"",pass:"",email:"",blog:""}};function s(){$(".myinput").attr("disabled",false)}function a(){$(".myinput").attr("disabled","disabled")}function o(){var t=true;$(".mustinput").each(function(){if($(this).val()===""){$(this).attr("class","form-control myinput mustinput label-warning");$(this).focus(function(){$(this).attr("class","form-control myinput mustinput")});t=false}});return t}$(document).ready(function(){a();toastr.info("连接服务器中..","Info");n.socket=io.connect(n.server);n.socket.on("connect",function(){toastr.success("连接服务器成功!","Success");n.socket.emit("user",{act:"checkreg"});s()}).on("disconnect",function(){toastr.error("服务器断开连接!","Error");a()}).on("reconnecting",function(){toastr.warning("无法连接服务器","Warning");a()}).on("user",function(t){n.res=t.reg;if(n.res){$("#reg_msg").attr("class","text-success");$("#reg_msg").html(" (๑´ڡ`๑) 注册成功!"+"<br>帐号：<code>"+n.tmp.name+"</code>"+"<br>密码：<code>"+n.tmp.pass+"</code>"+"<br>邮箱：<code>"+n.tmp.email+"</code>"+'<p class="text-info">点击快速登录：</p>'+'<a type="button" class="btn btn-success btn-block" href="/console/" target="_blank">终端模式</a>'+'<a type="button" class="btn btn-primary btn-block" href="/gui/" target="_blank">界面模式</a>');localStorage["mst_login_user"]=n.tmp.name;localStorage["mst_login_pass"]=n.tmp.pass}else{switch(t.msg){case"email_exists":t.msg="邮箱("+n.tmp.email+")已经被注册啦!";break;case"user_exists":t.msg="用户("+n.tmp.name+")已经被注册啦!";break;case"length":t.msg="输入长度不符合要求!";break;default:break}$("#reg_msg").attr("class","text-danger");$("#reg_msg").html(" (๑˘ ˘๑) 注册失败!"+"<br><b>因为：</b>"+t.msg)}$("#myModal").modal()}).on("noreg",function(t){if(!t.reg){a();toastr.warning("服务器已经关闭注册啦!<br>下一轮开放注册时间:"+t.time,"Warning")}});$("#myModal").on("hidden.bs.modal",function(t){n.btn.button("reset");s();if(n.res){location.reload()}});$(".myinput").tooltip();$("#reg").click(function(){if(o()){a();n.tmp.name=$("#user_name").val();n.tmp.pass=$("#user_pass").val();n.tmp.email=$("#user_email").val();n.tmp.blog=$("#user_blog").val();n.btn=$(this).button("loading");n.socket.emit("user",{act:"reg",name:n.tmp.name,email:n.tmp.email,pass:n.tmp.pass,blog:n.tmp.blog})}else{toastr.warning("请填写完整!","Warning")}});$(".myinput").keydown(function(t){if(t.keyCode===13){$("#reg").click()}})})})({},function(){return this}())})();
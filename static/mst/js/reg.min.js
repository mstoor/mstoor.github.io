var reg={server:mst_config_server,socket:null,btn:null,res:false,tmp:{name:"",pass:"",email:"",blog:""}};function enabledInput(){$(".myinput").attr("disabled",false)}function disabledInput(){$(".myinput").attr("disabled","disabled")}function checkInput(){var _ret=true;$(".mustinput").each(function(){if($(this).val()===""){$(this).attr("class","form-control myinput mustinput label-warning");$(this).focus(function(){$(this).attr("class","form-control myinput mustinput")});_ret=false}});return _ret}$(document).ready(function(){disabledInput();toastr.info("连接服务器中..","Info");reg.socket=io.connect(reg.server);reg.socket.on("connect",function(){toastr.success("连接服务器成功!","Success");reg.socket.emit("user",{act:"checkreg"});enabledInput()}).on("disconnect",function(){toastr.error("服务器断开连接!","Error");disabledInput()}).on("reconnecting",function(){toastr.warning("无法连接服务器","Warning");disabledInput()}).on("user",function(obj){reg.res=obj.reg;if(reg.res){$("#reg_msg").attr("class","text-success");$("#reg_msg").html(" (๑´ڡ`๑) 注册成功!"+"<br>帐号：<code>"+reg.tmp.name+"</code>"+"<br>密码：<code>"+reg.tmp.pass+"</code>"+"<br>邮箱：<code>"+reg.tmp.email+"</code>"+'<p class="text-info">点击快速登录：</p>'+'<a type="button" class="btn btn-success btn-block" href="/console/" target="_blank">终端模式</a>'+'<a type="button" class="btn btn-primary btn-block" href="/gui/" target="_blank">界面模式</a>');localStorage["mst_login_user"]=reg.tmp.name;localStorage["mst_login_pass"]=reg.tmp.pass}else{switch(obj.msg){case"email_exists":obj.msg="邮箱("+reg.tmp.email+")已经被注册啦!";break;case"user_exists":obj.msg="用户("+reg.tmp.name+")已经被注册啦!";break;case"length":obj.msg="输入长度不符合要求!";break;default:break}$("#reg_msg").attr("class","text-danger");$("#reg_msg").html(" (๑˘ ˘๑) 注册失败!"+"<br><b>因为：</b>"+obj.msg)}$("#myModal").modal()}).on("noreg",function(obj){if(!obj.reg){disabledInput();toastr.warning("服务器已经关闭注册啦!<br>下一轮开放注册时间:"+obj.time,"Warning")}});$("#myModal").on("hidden.bs.modal",function(e){reg.btn.button("reset");enabledInput();if(reg.res){location.reload()}});$(".myinput").tooltip();$("#reg").click(function(){if(checkInput()){disabledInput();reg.tmp.name=$("#user_name").val();reg.tmp.pass=$("#user_pass").val();reg.tmp.email=$("#user_email").val();reg.tmp.blog=$("#user_blog").val();reg.btn=$(this).button("loading");reg.socket.emit("user",{act:"reg",name:reg.tmp.name,email:reg.tmp.email,pass:reg.tmp.pass,blog:reg.tmp.blog})}else{toastr.warning("请填写完整!","Warning")}});$(".myinput").keydown(function(e){if(e.keyCode===13){$("#reg").click()}})});
//# sourceMappingURL=reg.min.map